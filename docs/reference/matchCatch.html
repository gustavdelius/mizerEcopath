<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function adjusts various model parameters for the selected species so
that the model in steady state reproduces the observed catch size
distribution, the observed yield and the observed production, if available."><title>Match the observed catch and yield — matchCatch • mizerEcopath</title><script src="../deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Match the observed catch and yield — matchCatch"><meta property="og:description" content="This function adjusts various model parameters for the selected species so
that the model in steady state reproduces the observed catch size
distribution, the observed yield and the observed production, if available."><!-- mathjax --><script src="file:///usr/share/javascript/mathjax/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mizerEcopath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9013</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gustavdelius/mizerEcopath/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Match the observed catch and yield</h1>
      <small class="dont-index">Source: <a href="https://github.com/gustavdelius/mizerEcopath/blob/HEAD/R/matchCatch.R" class="external-link"><code>R/matchCatch.R</code></a></small>
      <div class="d-none name"><code>matchCatch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function adjusts various model parameters for the selected species so
that the model in steady state reproduces the observed catch size
distribution, the observed yield and the observed production, if available.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">matchCatch</span><span class="op">(</span></span>
<span>  <span class="va">params</span>,</span>
<span>  species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">catch</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">2.05</span>,</span>
<span>  yield_lambda <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  production_lambda <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>params</dt>
<dd><p>A MizerParams object</p></dd>


<dt>species</dt>
<dd><p>The species for which to match the catch. Optional. By default
all target species are selected. A vector of species names, or a numeric
vector with the species indices, or a logical vector indicating for each
species whether it is to be selected (TRUE) or not.</p></dd>


<dt>catch</dt>
<dd><p>A data frame containing the observed binned catch data. It must
contain the following columns:</p><ul><li><p><code>length</code>: The start of each bin.</p></li>
<li><p><code>dl</code>: The width of each bin.</p></li>
<li><p><code>count</code>: The observed count for each bin.</p></li>
</ul></dd>


<dt>lambda</dt>
<dd><p>The slope of the community spectrum. Default is 2.05.</p></dd>


<dt>yield_lambda</dt>
<dd><p>A parameter that controls the strength of the penalty for
deviation from the observed yield.</p></dd>


<dt>production_lambda</dt>
<dd><p>A parameter that controls the strength of the penalty
for deviation from the observed production.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A MizerParams object with the adjusted external mortality, gear
selectivity, catchability and steady-state spectrum for the selected
species.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Currently this function is implemented only for the case where there is a
single gear catching each species.</p>
<p>The function sets new values for the following parameters:</p><ul><li><p><code>l50</code>: The size at which the gear selectivity is 50%.</p></li>
<li><p><code>l25</code>: The size at which the gear selectivity is 25%.</p></li>
<li><p><code>catchability</code>: The catchability of the gear.</p></li>
<li><p><code>mu_mat</code>: The external mortality at maturity.</p></li>
</ul><p>Only the parameters of the selected species are adjusted. The function then
recalculates the corresponding rate arrays in the params object. It sets the
initial size spectrum to the steady state size spectrum. The total biomass of
each species remains unchanged.</p>
<p>The function estimates these parameters by minimizing an objective function.
The objective function is the negative log likelihood of the observed catch
size distribution given the probabilities predicted by the model plus the sum
of squares difference between the log of the observed yield and the log of
the predicted yield, multiplied by <code>yield_lambda</code>, as well as the sum of
squares difference between the log of the observed production and the log of
the predicted production, multiplied by <code>production_lambda</code>.</p>
<p>The function deals with missing data in the following way, for each species
individually:</p><ul><li><p>If the observed yield is not available, the function will only match the
observed catch size distribution and the observed production.</p></li>
<li><p>If the observed production is not available, the function will only match the
observed catch size distribution and the observed yield.</p></li>
<li><p>If the observed catch size distribution is not available, the function will
only match the observed yield and the observed production.</p></li>
<li><p>If neither the observed yield nor the observed production are available, the
function raises an error.</p></li>
</ul><p>The catch predicted by the model is calculated by integrating the
catchability and the gear selectivity over the size distribution of the
species. The size distribution itself is shaped by the model through the
interplay between growth and mortality. This is why the gear selectivity and
catchability need to be adjusted together with the other parameters that
shape the size distribution.</p>
<p>The objective function is coded in C++ and the TMB package is used to compile
the objective function and to create functions for automatically calculating
the gradients. These are then passed to the <code>nlminb</code> function to minimize the
objective function.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other match functions: 
<code><a href="matchConsumption.html">matchConsumption</a>()</code>,
<code><a href="matchDiet.html">matchDiet</a>()</code>,
<code><a href="matchExtMortOnce.html">matchExtMortOnce</a>()</code>,
<code><a href="matchGonadicProportionOnce.html">matchGonadicProportionOnce</a>()</code>,
<code><a href="matchProduction.html">matchProduction</a>()</code>,
<code><a href="matchRespirationOnce.html">matchRespirationOnce</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu">matchCatch</span><span class="op">(</span><span class="va">celtic_params</span>, species <span class="op">=</span> <span class="st">"Hake"</span>, catch <span class="op">=</span> <span class="va">celtic_catch</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>For the following species `erepro` has been increased to the smallest possible value: erepro[Hake] = 0.869</span>
<span class="r-in"><span><span class="fu">plot_catch</span><span class="op">(</span><span class="va">params</span>, species <span class="op">=</span> <span class="st">"Hake"</span>, catch <span class="op">=</span> <span class="va">celtic_catch</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="matchCatch-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># The function leaves the biomass of the species unchanged</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu">getBiomass</span><span class="op">(</span><span class="va">params</span>, use_cutoff <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu">getBiomass</span><span class="op">(</span><span class="va">celtic_params</span>, use_cutoff <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          tol <span class="op">=</span> <span class="fl">1e-4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co"># It also leaves the energy available to an individual for reproduction</span></span></span>
<span class="r-in"><span><span class="co"># and growth unchanged</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu">getEReproAndGrowth</span><span class="op">(</span><span class="va">params</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu">getEReproAndGrowth</span><span class="op">(</span><span class="va">celtic_params</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co"># The initial size spectrum is set to the steady state size spectrum</span></span></span>
<span class="r-in"><span><span class="va">params_steady</span> <span class="op">&lt;-</span> <span class="fu">steadySingleSpecies</span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining steady state with diffusion</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu">initialN</span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, <span class="fu">initialN</span><span class="op">(</span><span class="va">params_steady</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Gustav Delius.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

